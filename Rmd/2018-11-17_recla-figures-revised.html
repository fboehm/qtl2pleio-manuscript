<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
  padding-top: 0px;
}
</style>

</head>

<body>

<h1 id="recla-analysis-updated-figures">Recla analysis: Updated figures</h1>
<p>Frederick Boehm 2019-01-19 14:06:02</p>
<h2 id="read-pvl-scan-results-from-files">Read pvl scan results from files</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a></code></pre></div>
<pre><code>## 
## Attaching package: 'dplyr'

## The following objects are masked from 'package:stats':
## 
##     filter, lag

## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">as_tibble</span>(<span class="kw">read.table</span>(<span class="st">&quot;recla-07-10.txt&quot;</span>)) -&gt;<span class="st"> </span>pvl0710</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">as_tibble</span>(<span class="kw">read.table</span>(<span class="st">&quot;recla-07-22.txt&quot;</span>)) -&gt;<span class="st"> </span>pvl0722</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw">as_tibble</span>(<span class="kw">read.table</span>(<span class="st">&quot;recla-10-22.txt&quot;</span>)) -&gt;<span class="st"> </span>pvl1022</a></code></pre></div>
<h2 id="load-recla-from-qtl2data">Load Recla from qtl2data</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(qtl2)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">file &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;https://raw.githubusercontent.com/rqtl/&quot;</span>,</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">               <span class="st">&quot;qtl2data/master/DO_Recla/recla.zip&quot;</span>)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">recla &lt;-<span class="st"> </span><span class="kw">read_cross2</span>(file)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co"># make sex a covariate for use in qtl2pleio::scan_pvl</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">recla[[<span class="dv">6</span>]][ , <span class="dv">1</span>, drop =<span class="st"> </span><span class="ot">FALSE</span>] -&gt;<span class="st"> </span>sex</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co"># insert pseudomarkers</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="kw">insert_pseudomarkers</span>(recla, <span class="dt">step =</span> <span class="fl">0.10</span>) -&gt;<span class="st"> </span>pseudomap</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">gm &lt;-<span class="st"> </span>pseudomap<span class="op">$</span><span class="st">`</span><span class="dt">8</span><span class="st">`</span></a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">probs &lt;-<span class="st"> </span><span class="kw">calc_genoprob</span>(recla, <span class="dt">map =</span> pseudomap)</a></code></pre></div>
<p>We now convert the genotype probabilities to haplotype dosages.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">aprobs &lt;-<span class="st"> </span><span class="kw">genoprob_to_alleleprob</span>(probs)</a></code></pre></div>
<p>We now calculate kinship matrices, by the “leave one chromosome out (loco)” method.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">kinship &lt;-<span class="st"> </span><span class="kw">calc_kinship</span>(aprobs, <span class="st">&quot;loco&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">recla<span class="op">$</span>pheno -&gt;<span class="st"> </span>ph</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw">log</span>(ph) -&gt;<span class="st"> </span>lph</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="kw">apply</span>(<span class="dt">FUN =</span> broman<span class="op">::</span>winsorize, <span class="dt">X =</span> lph, <span class="dt">MARGIN =</span> <span class="dv">2</span>) -&gt;<span class="st"> </span>wlph</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#colnames(wlph)[c(7, 10, 22)] &lt;- c(&quot;distance traveled in light&quot;, &quot;percent time in light&quot;, &quot;hot plate latency&quot;)</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="kw">as_tibble</span>(wlph) -&gt;<span class="st"> </span>wlph_tib</a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">sex2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">as.numeric</span>(sex <span class="op">==</span><span class="st"> &quot;female&quot;</span>), <span class="dt">ncol =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw">colnames</span>(sex2) &lt;-<span class="st"> &quot;female&quot;</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw">rownames</span>(sex2) &lt;-<span class="st"> </span><span class="kw">rownames</span>(aprobs[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">out &lt;-<span class="st"> </span><span class="kw">scan1</span>(<span class="dt">genoprobs =</span> aprobs, <span class="dt">pheno =</span> wlph, <span class="dt">kinship =</span> kinship, <span class="dt">addcovar =</span> sex2, <span class="dt">reml =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="kw">saveRDS</span>(out, <span class="st">&quot;scan1.rds&quot;</span>) <span class="co"># save scan1 results in case we want to tweak figures</span></a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">(peaks &lt;-<span class="st"> </span><span class="kw">find_peaks</span>(out, pseudomap, <span class="dt">threshold =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="st">  </span><span class="kw">arrange</span>(chr, pos) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">   </span><span class="kw">select</span>(<span class="op">-</span><span class="st"> </span>lodindex))</a></code></pre></div>
<pre><code>##                    lodcolumn chr     pos      lod
## 1                         bw   1 23.9075 5.471580
## 2         OF_distance_first4   1 43.2385 5.772977
## 3             LD_transitions   1 95.8075 5.028258
## 4                OF_distance   2 49.9770 5.544458
## 5                         bw   2 52.3932 7.352334
## 6            OF_immobile_pct   2 53.2646 9.771813
## 7  VC_bottom_distance_first4   2 71.0160 6.531654
## 8         OF_distance_first4   3 10.7360 5.541166
## 9  VC_bottom_distance_first4   3 16.3700 5.518637
## 10           VC_top_time_pct   3 17.9390 5.951067
## 11         LD_distance_light   3 23.4390 5.203246
## 12                        bw   3 24.8390 5.632714
## 13        VC_top_time_first4   3 48.1280 6.144073
## 14           VC_top_velocity   3 48.5630 6.264824
## 15        VC_top_time_first4   4  3.5340 5.016970
## 16             OF_corner_pct   4  9.0111 6.272996
## 17           OF_immobile_pct   4 37.5206 5.529985
## 18         LD_distance_light   4 71.2992 5.040185
## 19                        bw   5 10.0740 5.728865
## 20 VC_bottom_distance_first4   5 19.9741 5.419061
## 21        VC_top_time_first4   5 20.0741 6.075282
## 22        VC_bottom_distance   5 20.5930 5.691913
## 23        VC_bottom_time_pct   5 20.5930 6.360001
## 24       TS_latency_immobile   5 43.3504 5.995115
## 25             OF_corner_pct   5 64.2551 5.665658
## 26           OF_immobile_pct   6 53.4292 6.968771
## 27     TS_frequency_climbing   6 57.0362 5.361091
## 28                        bw   7  9.1778 6.057098
## 29          TS_time_immobile   7 49.4778 8.067612
## 30        VC_bottom_distance   7 54.5591 5.011113
## 31        OF_distance_first4   7 57.9454 5.327302
## 32           VC_top_distance   7 83.8778 5.724788
## 33           OF_immobile_pct   7 83.9778 5.823556
## 34     TS_frequency_climbing   8 48.1732 5.483064
## 35         LD_distance_light   8 55.2762 5.323391
## 36              LD_light_pct   8 55.2762 5.274185
## 37                HP_latency   8 57.7732 6.223739
## 38         LD_distance_light   9 36.6965 5.196968
## 39              LD_light_pct   9 36.6965 5.417419
## 40        VC_top_time_first4   9 38.4834 5.109813
## 41           VC_top_time_pct   9 39.2680 6.356432
## 42                HP_latency   9 46.8502 5.222074
## 43                        bw  10  3.7781 6.526199
## 44        OF_distance_first4  10 29.6698 5.462975
## 45        VC_bottom_time_pct  10 32.5438 5.432804
## 46          OF_periphery_pct  10 74.8530 5.246487
## 47           VC_top_distance  11  7.8200 6.245803
## 48    VC_top_distance_first4  11 11.6236 5.486915
## 49 VC_bottom_distance_first4  11 54.3420 5.367052
## 50            LD_transitions  11 58.9000 5.903217
## 51     VC_bottom_transitions  11 60.5984 5.114051
## 52              LD_light_pct  11 63.3943 6.464176
## 53         LD_distance_light  11 63.4514 6.373437
## 54           VC_top_time_pct  12 20.5776 6.950144
## 55        VC_bottom_velocity  12 21.7760 5.653292
## 56             OF_center_pct  12 35.5140 6.399422
## 57                HP_latency  12 43.5150 5.131074
## 58          OF_periphery_pct  12 53.5776 7.240951
## 59             OF_corner_pct  13 59.7966 6.594594
## 60     VC_bottom_time_first4  14 11.9183 5.204369
## 61 VC_bottom_distance_first4  14 12.5316 5.763233
## 62     VC_bottom_transitions  14 12.5316 6.478533
## 63           VC_top_velocity  14 12.7819 6.840412
## 64        VC_bottom_distance  14 14.5316 5.592030
## 65     TS_frequency_climbing  14 21.1141 5.372594
## 66             OF_center_pct  14 53.7316 5.377182
## 67     TS_frequency_climbing  15 12.6680 6.043265
## 68              LD_light_pct  15 15.2374 5.674922
## 69        OF_distance_first4  16 23.2656 5.242101
## 70           VC_top_distance  17 15.6390 6.669275
## 71           VC_top_velocity  18  8.3750 5.558628
## 72        VC_top_time_first4  18 17.8068 6.246206
## 73            LD_transitions  18 37.4182 5.090332
## 74 VC_bottom_distance_first4  19 24.9615 7.362557
## 75     VC_bottom_time_first4  19 24.9615 7.499959
## 76           OF_immobile_pct  19 31.9505 5.639812
## 77                HP_latency  19 47.7977 5.485000
</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">peaks8 &lt;-<span class="st"> </span>peaks <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(chr <span class="op">==</span><span class="st"> </span><span class="dv">8</span>, pos <span class="op">&gt;</span><span class="st"> </span><span class="dv">50</span>, pos <span class="op">&lt;</span><span class="st"> </span><span class="dv">60</span>)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">pos_LD_light_pct &lt;-<span class="st"> </span>peaks8 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(lodcolumn <span class="op">==</span><span class="st"> &quot;LD_light_pct&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="st">  </span><span class="kw">select</span>(pos)</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">pos_HP_latency &lt;-<span class="st"> </span>peaks8 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="st">  </span><span class="kw">filter</span>(lodcolumn <span class="op">==</span><span class="st"> &quot;HP_latency&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="st">  </span><span class="kw">select</span>(pos)</a></code></pre></div>
<h2 id="find-peaks-for-two-traits">Find peaks for two traits</h2>
<p>Make a supplementary table for manuscript.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">xtable<span class="op">::</span><span class="kw">xtable</span>(<span class="kw">find_peaks</span>(out[, <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">22</span>)], pseudomap, <span class="dt">threshold =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="st">  </span><span class="kw">arrange</span>(chr, pos) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="st">   </span><span class="kw">select</span>(<span class="op">-</span><span class="st"> </span>lodindex))</a></code></pre></div>
<pre><code>## % latex table generated in R 3.5.2 by xtable 1.8-3 package
## % Sat Jan 19 14:20:25 2019
## \begin{table}[ht]
## \centering
## \begin{tabular}{rllrr}
##   \hline
##  &amp; lodcolumn &amp; chr &amp; pos &amp; lod \\ 
##   \hline
## 1 &amp; LD\_light\_pct &amp; 8 &amp; 55.28 &amp; 5.27 \\ 
##   2 &amp; HP\_latency &amp; 8 &amp; 57.77 &amp; 6.22 \\ 
##   3 &amp; LD\_light\_pct &amp; 9 &amp; 36.70 &amp; 5.42 \\ 
##   4 &amp; HP\_latency &amp; 9 &amp; 46.85 &amp; 5.22 \\ 
##   5 &amp; LD\_light\_pct &amp; 11 &amp; 63.39 &amp; 6.46 \\ 
##   6 &amp; HP\_latency &amp; 12 &amp; 43.52 &amp; 5.13 \\ 
##   7 &amp; LD\_light\_pct &amp; 15 &amp; 15.24 &amp; 5.67 \\ 
##   8 &amp; HP\_latency &amp; 19 &amp; 47.80 &amp; 5.48 \\ 
##    \hline
## \end{tabular}
## \end{table}
</code></pre>
<h2 id="correlation">Correlation</h2>
<p>Given that the two traits “percent time in light” and “distance traveled in light” share a peak, we want to ask how correlated they are.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">cor</span>(wlph[ , <span class="dv">7</span>], wlph[ , <span class="dv">10</span>], <span class="dt">use =</span> <span class="st">&quot;complete.obs&quot;</span>)</a></code></pre></div>
<pre><code>## [1] 0.8859402
</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">cor</span>(wlph[ , <span class="dv">22</span>], wlph[ , <span class="dv">10</span>], <span class="dt">use =</span> <span class="st">&quot;complete.obs&quot;</span>)</a></code></pre></div>
<pre><code>## [1] -0.1507317
</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">cor</span>(wlph[ , <span class="dv">7</span>], wlph[ , <span class="dv">22</span>], <span class="dt">use =</span> <span class="st">&quot;complete.obs&quot;</span>)</a></code></pre></div>
<pre><code>## [1] -0.143598
</code></pre>
<h2 id="plots">Plots</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">library</span>(qtl2pleio)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw">colnames</span>(recla<span class="op">$</span>pheno)[<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">22</span>)] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;percent time in light&quot;</span>, <span class="st">&quot;hot plate latency&quot;</span>)</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">p1022 &lt;-<span class="st"> </span><span class="kw">tidy_scan_pvl</span>(pvl1022, <span class="dt">pmap =</span> gm) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="st">  </span><span class="kw">add_intercepts</span>(<span class="kw">c</span>(<span class="kw">as.numeric</span>(pos_LD_light_pct), <span class="kw">as.numeric</span>(pos_HP_latency))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="st">  </span><span class="kw">plot_pvl</span>(<span class="dt">phenames =</span> <span class="kw">colnames</span>(recla<span class="op">$</span>pheno)[<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">22</span>)]) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;percent time in light and hot plate latency&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Column `marker`/`marker1` joining character vector and factor,
## coercing into character vector

## Warning: Column `marker2`/`marker` joining factor and character vector,
## coercing into character vector
</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;profile.eps&quot;</span>, <span class="dt">plot =</span> p1022)</a></code></pre></div>
<pre><code>## Saving 7 x 5 in image

## Warning: Removed 208 rows containing missing values (geom_path).
</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="dt">filename =</span>  <span class="st">&quot;profile.svg&quot;</span>, <span class="dt">plot =</span> p1022)</a></code></pre></div>
<pre><code>## Saving 7 x 5 in image

## Warning: Removed 208 rows containing missing values (geom_path).
</code></pre>
<h2 id="scatter-plot-of-phenotypes">Scatter plot of phenotypes</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">scatter1022 &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">data =</span> wlph_tib, <span class="kw">aes</span>(<span class="dt">y =</span> HP_latency, <span class="dt">x =</span> LD_light_pct)) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;percent time in light&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;hot plate latency&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;hot plate latency vs. percent time in light&quot;</span>)</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;scatter.eps&quot;</span>, <span class="dt">plot =</span> scatter1022)</a></code></pre></div>
<pre><code>## Saving 7 x 5 in image

## Warning: Removed 3 rows containing missing values (geom_point).
</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;scatter.svg&quot;</span>, <span class="dt">plot =</span> scatter1022)</a></code></pre></div>
<pre><code>## Saving 7 x 5 in image

## Warning: Removed 3 rows containing missing values (geom_point).
</code></pre>
<h2 id="genome-wide-lod-plots-for-the-traits-from-recla">Genome-wide LOD plots for the traits from Recla</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">setEPS</span>()</a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="kw">postscript</span>(<span class="st">&quot;genomewide_lod_trait10.eps&quot;</span>)</a>
<a class="sourceLine" id="cb31-3" data-line-number="3"><span class="kw">plot</span>(out, <span class="dt">map =</span> pseudomap, <span class="dt">lodcolumn =</span> <span class="dv">10</span>, <span class="dt">main =</span> <span class="st">&quot;percent time in light&quot;</span>)</a>
<a class="sourceLine" id="cb31-4" data-line-number="4"><span class="kw">dev.off</span>()</a></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2
</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">setEPS</span>()</a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="kw">postscript</span>(<span class="st">&quot;genomewide_lod_trait22.eps&quot;</span>)</a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="kw">plot</span>(out, <span class="dt">map =</span> pseudomap, <span class="dt">lodcolumn =</span> <span class="dv">22</span>, <span class="dt">main =</span> <span class="st">&quot;hot plate latency&quot;</span>)</a>
<a class="sourceLine" id="cb33-4" data-line-number="4"><span class="kw">dev.off</span>()</a></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2
</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw">setEPS</span>()</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="kw">postscript</span>(<span class="st">&quot;genomewide_lod_trait10.eps&quot;</span>)</a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="kw">plot</span>(out, <span class="dt">map =</span> pseudomap, <span class="dt">lodcolumn =</span> <span class="dv">10</span>, <span class="dt">main =</span> <span class="st">&quot;percent time in light&quot;</span>)</a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="kw">dev.off</span>()</a></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2
</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">svg</span>(<span class="st">&quot;genomewide_lod_trait10.svg&quot;</span>)</a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="kw">plot</span>(out, <span class="dt">map =</span> pseudomap, <span class="dt">lodcolumn =</span> <span class="dv">10</span>, <span class="dt">main =</span> <span class="st">&quot;percent time in light&quot;</span>)</a>
<a class="sourceLine" id="cb37-3" data-line-number="3"><span class="kw">dev.off</span>()</a></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2
</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">setEPS</span>()</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="kw">postscript</span>(<span class="st">&quot;genomewide_lod_trait22.eps&quot;</span>)</a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="kw">plot</span>(out, <span class="dt">map =</span> pseudomap, <span class="dt">lodcolumn =</span> <span class="dv">22</span>, <span class="dt">main =</span> <span class="st">&quot;hot plate latency&quot;</span>)</a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="kw">dev.off</span>()</a></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2
</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">svg</span>(<span class="st">&quot;genomewide_lod_trait22.svg&quot;</span>)</a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="kw">plot</span>(out, <span class="dt">map =</span> pseudomap, <span class="dt">lodcolumn =</span> <span class="dv">22</span>, <span class="dt">main =</span> <span class="st">&quot;hot plate latency&quot;</span>)</a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="kw">dev.off</span>()</a></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2
</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="co"># genomewide lod plots for 10 &amp; 22, pct time in light and hot plate latency</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="kw">setEPS</span>()</a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="kw">postscript</span>(<span class="st">&quot;genomewide_lods_10-22.eps&quot;</span>)</a>
<a class="sourceLine" id="cb43-4" data-line-number="4"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb43-5" data-line-number="5"><span class="kw">plot</span>(out, <span class="dt">map =</span> pseudomap, <span class="dt">lodcolumn =</span> <span class="dv">10</span>, <span class="dt">main =</span> <span class="st">&quot;percent time in light&quot;</span>)</a>
<a class="sourceLine" id="cb43-6" data-line-number="6"><span class="kw">plot</span>(out, <span class="dt">map =</span> pseudomap, <span class="dt">lodcolumn =</span> <span class="dv">22</span>, <span class="dt">main =</span> <span class="st">&quot;hot plate latency&quot;</span>)</a>
<a class="sourceLine" id="cb43-7" data-line-number="7"><span class="kw">dev.off</span>()</a></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2
</code></pre>
<h2 id="lod-plots-for-both-traits-on-chromosome-8">LOD plots for both traits on Chromosome 8</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="co"># first, look at dimensions of `out`</span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="kw">dim</span>(out)</a></code></pre></div>
<pre><code>## [1] 20205    26
</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1">cumsum_map_lengths &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dt">FUN =</span> length, <span class="dt">X =</span> pseudomap) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-2" data-line-number="2"><span class="st">  </span><span class="kw">cumsum</span>()</a>
<a class="sourceLine" id="cb47-3" data-line-number="3">out[(cumsum_map_lengths[<span class="dv">7</span>] <span class="op">+</span><span class="st"> </span><span class="dv">650</span>)<span class="op">:</span>(cumsum_map_lengths[<span class="dv">7</span>] <span class="op">+</span><span class="st"> </span><span class="dv">999</span>), ] -&gt;<span class="st"> </span>chr8_lods</a>
<a class="sourceLine" id="cb47-4" data-line-number="4"><span class="kw">setEPS</span>()</a>
<a class="sourceLine" id="cb47-5" data-line-number="5"><span class="kw">postscript</span>(<span class="st">&quot;chr8-lods.eps&quot;</span>)</a>
<a class="sourceLine" id="cb47-6" data-line-number="6"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb47-7" data-line-number="7"><span class="kw">plot_scan1</span>(chr8_lods, <span class="dt">chr =</span> <span class="dv">8</span>, <span class="dt">map =</span> pseudomap, <span class="dt">lodcolumn =</span> <span class="dv">10</span>, <span class="dt">main =</span> <span class="st">&quot;percent time in light&quot;</span>)</a>
<a class="sourceLine" id="cb47-8" data-line-number="8"><span class="kw">plot_scan1</span>(chr8_lods, <span class="dt">chr =</span> <span class="dv">8</span>, <span class="dt">map =</span> pseudomap, <span class="dt">lodcolumn =</span> <span class="dv">22</span>, <span class="dt">main =</span> <span class="st">&quot;hot plate latency&quot;</span>)</a>
<a class="sourceLine" id="cb47-9" data-line-number="9"><span class="kw">dev.off</span>()</a></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2
</code></pre>
<h2 id="allele-effects-plots-on-chr-8-for-recla-traits">Allele effects plots on chr 8 for Recla traits</h2>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw">scan1coef</span>(aprobs[ , <span class="dv">8</span>], <span class="dt">pheno =</span> wlph[, <span class="dv">10</span>], <span class="dt">kinship =</span> kinship<span class="op">$</span><span class="st">`</span><span class="dt">8</span><span class="st">`</span>, </a>
<a class="sourceLine" id="cb49-2" data-line-number="2">          <span class="dt">reml =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb49-3" data-line-number="3">          <span class="dt">addcovar =</span> sex2) -&gt;<span class="st"> </span>s1c_<span class="dv">10</span></a>
<a class="sourceLine" id="cb49-4" data-line-number="4"><span class="kw">scan1coef</span>(aprobs[ , <span class="dv">8</span>], <span class="dt">pheno =</span> wlph[, <span class="dv">22</span>], <span class="dt">kinship =</span> kinship<span class="op">$</span><span class="st">`</span><span class="dt">8</span><span class="st">`</span>, </a>
<a class="sourceLine" id="cb49-5" data-line-number="5">          <span class="dt">reml =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb49-6" data-line-number="6">          <span class="dt">addcovar =</span> sex2) -&gt;<span class="st"> </span>s1c_<span class="dv">22</span></a></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="co"># save scan1coef output objects for fine-tuning of figures</span></a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="kw">saveRDS</span>(s1c_<span class="dv">10</span>, <span class="st">&quot;s1c_10.rds&quot;</span>) <span class="co"># percent time in light</span></a>
<a class="sourceLine" id="cb50-3" data-line-number="3"><span class="kw">saveRDS</span>(s1c_<span class="dv">22</span>, <span class="st">&quot;s1c_22.rds&quot;</span>) <span class="co"># hot plate latency</span></a></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="co"># ensure that subsets are scan1output objects</span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2">s1c_10s &lt;-<span class="st"> </span>s1c_<span class="dv">10</span>[<span class="dv">650</span><span class="op">:</span><span class="dv">999</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>]</a>
<a class="sourceLine" id="cb51-3" data-line-number="3">s1c_22s &lt;-<span class="st"> </span>s1c_<span class="dv">22</span>[<span class="dv">650</span><span class="op">:</span><span class="dv">999</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>]</a></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="kw">setEPS</span>()</a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="kw">postscript</span>(<span class="st">&quot;coefs.eps&quot;</span>)</a>
<a class="sourceLine" id="cb52-3" data-line-number="3"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb52-4" data-line-number="4"><span class="kw">plot_coefCC</span>(s1c_10s, <span class="dt">map =</span> pseudomap, <span class="dt">main =</span> <span class="st">&quot;percent time in light&quot;</span>, <span class="dt">legend =</span> <span class="st">&quot;topright&quot;</span>)</a>
<a class="sourceLine" id="cb52-5" data-line-number="5"><span class="kw">plot_coefCC</span>(s1c_22s, <span class="dt">map =</span> pseudomap, <span class="dt">main =</span> <span class="st">&quot;hot plate latency&quot;</span>)</a>
<a class="sourceLine" id="cb52-6" data-line-number="6"><span class="kw">dev.off</span>()</a></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2
</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw">svg</span>(<span class="st">&quot;coefs.svg&quot;</span>)</a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb54-3" data-line-number="3"><span class="kw">plot_coefCC</span>(s1c_10s, <span class="dt">map =</span> pseudomap, <span class="dt">main =</span> <span class="st">&quot;percent time in light&quot;</span>, <span class="dt">legend =</span> <span class="st">&quot;topright&quot;</span>)</a>
<a class="sourceLine" id="cb54-4" data-line-number="4"><span class="kw">plot_coefCC</span>(s1c_22s, <span class="dt">map =</span> pseudomap, <span class="dt">main =</span> <span class="st">&quot;hot plate latency&quot;</span>)</a>
<a class="sourceLine" id="cb54-5" data-line-number="5"><span class="kw">dev.off</span>()</a></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2
</code></pre>
<h2 id="session-info">Session info</h2>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1">devtools<span class="op">::</span><span class="kw">session_info</span>()</a></code></pre></div>
<pre><code>## ─ Session info ──────────────────────────────────────────────────────────
##  setting  value                                      
##  version  R version 3.5.2 Patched (2018-12-24 r75893)
##  os       macOS Mojave 10.14.2                       
##  system   x86_64, darwin15.6.0                       
##  ui       X11                                        
##  language (EN)                                       
##  collate  en_US.UTF-8                                
##  ctype    en_US.UTF-8                                
##  tz       America/Chicago                            
##  date     2019-01-19                                 
## 
## ─ Packages ──────────────────────────────────────────────────────────────
##  package     * version    date       lib source                           
##  assertthat    0.2.0      2017-04-11 [1] CRAN (R 3.5.0)                   
##  backports     1.1.3      2018-12-14 [1] CRAN (R 3.5.0)                   
##  bindr         0.1.1      2018-03-13 [1] CRAN (R 3.5.0)                   
##  bindrcpp    * 0.2.2      2018-03-29 [1] CRAN (R 3.5.0)                   
##  bit           1.1-14     2018-05-29 [1] CRAN (R 3.5.0)                   
##  bit64         0.9-7      2017-05-08 [1] CRAN (R 3.5.0)                   
##  blob          1.1.1      2018-03-25 [1] CRAN (R 3.5.0)                   
##  broman        0.68-2     2018-07-25 [1] CRAN (R 3.5.0)                   
##  callr         3.1.1      2018-12-21 [1] CRAN (R 3.5.0)                   
##  cli           1.0.1      2018-09-25 [1] CRAN (R 3.5.0)                   
##  colorspace    1.3-2      2016-12-14 [1] CRAN (R 3.5.0)                   
##  crayon        1.3.4      2017-09-16 [1] CRAN (R 3.5.0)                   
##  data.table    1.11.8     2018-09-30 [1] CRAN (R 3.5.0)                   
##  DBI           1.0.0      2018-05-02 [1] CRAN (R 3.5.0)                   
##  desc          1.2.0      2018-05-01 [1] CRAN (R 3.5.0)                   
##  devtools      2.0.1      2018-10-26 [1] CRAN (R 3.5.2)                   
##  digest        0.6.18     2018-10-10 [1] CRAN (R 3.5.0)                   
##  dplyr       * 0.7.8      2018-11-10 [1] CRAN (R 3.5.0)                   
##  evaluate      0.12       2018-10-09 [1] CRAN (R 3.5.0)                   
##  fs            1.2.6      2018-08-23 [1] CRAN (R 3.5.0)                   
##  gdtools     * 0.1.7      2018-02-27 [1] CRAN (R 3.5.0)                   
##  ggplot2     * 3.1.0      2018-10-25 [1] CRAN (R 3.5.0)                   
##  glue          1.3.0      2018-07-17 [1] CRAN (R 3.5.0)                   
##  gtable        0.2.0      2016-02-26 [1] CRAN (R 3.5.0)                   
##  htmltools     0.3.6      2017-04-28 [1] CRAN (R 3.5.0)                   
##  jsonlite      1.6        2018-12-07 [1] CRAN (R 3.5.0)                   
##  knitr         1.21       2018-12-10 [1] CRAN (R 3.5.2)                   
##  labeling      0.3        2014-08-23 [1] CRAN (R 3.5.0)                   
##  lazyeval      0.2.1      2017-10-29 [1] CRAN (R 3.5.0)                   
##  lubridate     1.7.4      2018-04-11 [1] CRAN (R 3.5.0)                   
##  magrittr      1.5        2014-11-22 [1] CRAN (R 3.5.0)                   
##  memoise       1.1.0      2017-04-21 [1] CRAN (R 3.5.0)                   
##  munsell       0.5.0      2018-06-12 [1] CRAN (R 3.5.0)                   
##  pillar        1.3.1      2018-12-15 [1] CRAN (R 3.5.0)                   
##  pkgbuild      1.0.2      2018-10-16 [1] CRAN (R 3.5.0)                   
##  pkgconfig     2.0.2      2018-08-16 [1] CRAN (R 3.5.0)                   
##  pkgload       1.0.2      2018-10-29 [1] CRAN (R 3.5.0)                   
##  plyr          1.8.4      2016-06-08 [1] CRAN (R 3.5.0)                   
##  prettyunits   1.0.2      2015-07-13 [1] CRAN (R 3.5.0)                   
##  processx      3.2.1      2018-12-05 [1] CRAN (R 3.5.0)                   
##  ps            1.3.0      2018-12-21 [1] CRAN (R 3.5.0)                   
##  purrr         0.2.5      2018-05-29 [1] CRAN (R 3.5.0)                   
##  qtl2        * 0.17-9     2018-12-25 [1] Github (rqtl/qtl2@1c007a2)       
##  qtl2pleio   * 0.1.2.9000 2018-12-31 [1] Github (fboehm/qtl2pleio@be41d66)
##  R6            2.3.0      2018-10-04 [1] CRAN (R 3.5.0)                   
##  Rcpp          1.0.0.1    2018-12-28 [1] Github (RcppCore/Rcpp@0c9f683)   
##  remotes       2.0.2      2018-10-30 [1] CRAN (R 3.5.0)                   
##  rlang         0.3.0.1    2018-10-25 [1] CRAN (R 3.5.0)                   
##  rmarkdown     1.11       2018-12-08 [1] CRAN (R 3.5.0)                   
##  rprojroot     1.3-2      2018-01-03 [1] CRAN (R 3.5.0)                   
##  RSQLite       2.1.1      2018-05-06 [1] CRAN (R 3.5.0)                   
##  scales        1.0.0      2018-08-09 [1] CRAN (R 3.5.0)                   
##  sessioninfo   1.1.1      2018-11-05 [1] CRAN (R 3.5.0)                   
##  stringi       1.2.4      2018-07-20 [1] CRAN (R 3.5.0)                   
##  stringr       1.3.1      2018-05-10 [1] CRAN (R 3.5.0)                   
##  svglite       1.2.1      2017-09-11 [1] CRAN (R 3.5.0)                   
##  testthat      2.0.1      2018-10-13 [1] CRAN (R 3.5.0)                   
##  tibble        1.4.2      2018-01-22 [1] CRAN (R 3.5.0)                   
##  tidyselect    0.2.5      2018-10-11 [1] CRAN (R 3.5.0)                   
##  usethis       1.4.0      2018-08-14 [1] CRAN (R 3.5.0)                   
##  withr         2.1.2      2018-03-15 [1] CRAN (R 3.5.0)                   
##  xfun          0.4        2018-10-23 [1] CRAN (R 3.5.0)                   
##  xtable        1.8-3      2018-08-29 [1] CRAN (R 3.5.0)                   
##  yaml          2.2.0      2018-07-25 [1] CRAN (R 3.5.0)                   
## 
## [1] /Library/Frameworks/R.framework/Versions/3.5/Resources/library
</code></pre>

</body>
</html>
