---
title: "Recla analysis - determining the LRT statistics & p-values"
author: "Frederick Boehm"
date: "`r lubridate::now()`"
output: github_document
---

In this document, we use the 1000 files (for each of the bivariate traits) that each contain a likelihood ratio test statistic for a bootstrap sample. 


## Load the scan_pvl results for each of the 3 bivariate traits

```{r}
library(dplyr)
as_tibble(read.table("recla-07-22.txt")) -> out_0722
as_tibble(read.table("recla-07-10.txt")) -> out_0710
as_tibble(read.table("recla-10-22.txt")) -> out_1022
```

```{r}
library(qtl2pleio)
calc_lrt_tib(out_0722) # run 562
calc_lrt_tib(out_0710) # run 563
calc_lrt_tib(out_1022) # run 561
```


## Working with the CHTC results files

Our bootstrap samples were each analyzed with computing resources from the Center for High-Throughput Computing (CHTC) at UW-Madison.

```{bash}
ls ../chtc/Recla-bootstrap/submit_files/*run561*.txt | wc
ls ../chtc/Recla-bootstrap/submit_files/*run562*.txt | wc
ls ../chtc/Recla-bootstrap/submit_files/*run563*.txt | wc
```

We see that each analysis has the required 1000 files. 


### Run 561

```{r}
directory <- "../chtc/Recla-bootstrap/submit_files"
fns <- dir(directory, pattern = "recla-boot-run561", full.names = TRUE)
i <- 1
out <- list()
for (fn in fns){
  read.table(fn) -> out[[i]]
  i <- i + 1
}
sum(do.call("rbind", out) > calc_lrt_tib(out_1022))
```


## Run 562

```{r}
fns <- dir(directory, pattern = "recla-boot-run562", full.names = TRUE)
i <- 1
out <- list()
for (fn in fns){
  read.table(fn) -> out[[i]]
  i <- i + 1
}
sum(do.call("rbind", out) > calc_lrt_tib(out_0722))
```


## Run 563

```{r}
fns <- dir(directory, pattern = "recla-boot-run563", full.names = TRUE)
i <- 1
out <- list()
for (fn in fns){
  read.table(fn) -> out[[i]]
  i <- i + 1
}
sum(do.call("rbind", out) > calc_lrt_tib(out_0710))
```


```{r}
devtools::session_info()
```




